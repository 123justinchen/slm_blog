+++
title = "空间光调制器产生任意空间分布点阵"
date = 2022-08-31

[taxonomies]
categories = ["算法"]
tags = ["GSW", "matlab"]
+++

  
# 1. 为啥这个问题不能直接算？  
对于了解过傅里叶光学的小伙伴，已知一个平面上的复振幅（振幅+相位）分布，就可以通过计算得出光经过一些光学元件或者一段距离的传播后在某一平面上的复振幅分布。 用个简单的算式写如下：
![](https://s3.bmp.ovh/imgs/2022/08/31/e7c0c8b45a94fe41.png)

但是我们要解决的问题不太一样，下图是一个简易的setup。通常我们用一个空间光调制器（spatial light modulator SLM）放置在透镜的前焦平面上，希望能够在探测屏幕上观测到生成的点阵。  
![](https://s3.bmp.ovh/imgs/2022/08/31/c717217fd8035680.jpg)

在这个问题中，我们知道两个平面上的振幅，要求解前焦平面上的相位分布。

这个问题就不是很直观了，我们知道$E_{in}$,$E_{out}$不在意$\Phi_{out}$  （当然也可以在意，不过这种时候就不一定有解了），想要求解一个使得等式成立的$\Phi_{in}$。这个方程的求解就变得复杂起来，据作者了解，并未找到关于该问题的解析解。所以诸多工作都是在数学上寻找近似解。  
# 2. 啥是GS算法  
说到寻找近似解，1972年 Gerchberg 和 Saxton 就已经提出了GS算法用来计算上面描述的问题。这里是个流程图：

![](https://pic3.zhimg.com/80/v2-7e56b0ecb8d9d8151321992c9eb6d902_1440w.jpg)  

解释下流程，注意这里面所有的项目都是离散的：

a. 随机赋值相位给$\Phi_{in}$   

b. 把入射光振幅$E_{in}$和$\Phi_{in}$  放在一起，丢给离散傅里叶变换，算出来透镜后焦平面上的振幅和相位。  

c. 如果不收敛，就把算出来的振幅替换成目标光强分布的平方跟。再次丢进逆傅里叶变换。如果收敛，congratulations！找到想要的 $\Phi_{in}$ 了  

d. 逆傅里叶变换的结果中的相位作为新的  ,跳到步骤二。  

在实际操作中想说几点，第一个这个方法理论上可以用于在光学上实现任意的灰度图（涉及到不同波长的颜色就是另一个值得写很多文章的方向了），第二个是如果计算多个点阵，点的大小很小，比如在离散化的时候只有一个像素点，那么算出来的往往不够准确，这是由采样定理决定的，可以把两个平面的矩阵大小扩大一些计算会得到更为精准的表示。第三个就是这个方法全部基于电脑计算，但是实际情况中，SLM 的 curvature，光学元件的一些缺陷都会导致做出来的东西和计算一直有个差距。

# 3. 一丢丢改良， GSW，和基于实验的反馈
  ![](https://pic4.zhimg.com/80/v2-d8eeb89fbb49fef6a81bc421b0b225e3_1440w.jpg)  

这个方法可以用一个1k清晰度的SLM产生上万个任意光强分布的点阵，主要的改动点相对于上面提到的方法有以下几个：  

加入一个补偿因子g，就是说迭代中每次在焦平面生成了一个点阵分布，我就算一下和我想要的强度分布有多大差别，如果比我想要的少，就给这个点一个大于1的g，如果比我想要的多，就给这个点一个小于1的g，把g和目标强度的平方根乘在一起再去替换，可以让迭代的收敛速度变快。
既然提到补偿银子要测量每次迭代产生的点阵分布的强度，那么这个强度用实验上的数据是更好的，可以规避掉理论和实验上的误差。所以每次算出一个  $\Phi_{in}$就直接把这个相位实验中加到SLM上，再用一个相机拍下点阵位置，就可以得到相应的振幅值，不需要在计算机上计算FFT
一些其他的思考：  

最近在看一些用SLM生成hologram的文章，除了上面提到的迭代算法，现在也在有一些人做非迭代算法。蛮好奇能不能用机器学习的方法去学一学呢？ 神经网络这个模型就是在寻找一个存在多个非精确的数值解的问题的local minimum。似乎和这个问题有一些共性。  

Appendix：

以下是 matlab 算法链接，可以产生任意强度的点阵分布：

GitHub: euphy665/Optical-Neural-Network: https://doi.org/10.1364/OPTICA.6.001132 (github.com)  


本篇blog参考文献：  
[链接](https://zhuanlan.zhihu.com/p/435432249)